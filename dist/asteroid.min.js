!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("wolfy87-eventemitter")):"function"==typeof define&&define.amd?define(["wolfy87-eventemitter"],t):"object"==typeof exports?exports.Asteroid=t(require("wolfy87-eventemitter")):e.Asteroid=t(e["wolfy87-eventemitter"])}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function u(e){var t=[f,h,b,p,y].concat(e),n=function(){var e=this,n=arguments;t.forEach(function(t){var r=t.init;return r&&r.apply(e,n)})};return n.prototype=t.reduce(function(e,t){return i({},e,t)},s["default"].prototype),delete n.prototype.init,n}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.createClass=u;var c=n(1),s=o(c),a=n(2),f=r(a),l=n(4),p=r(l),d=n(7),h=r(d),v=n(8),y=r(v),g=n(9),b=r(g)},function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=this,n=e.endpoint,r=e.SocketConstructor,o=void 0===r?WebSocket:r;this.endpoint=n,this.ddp=new i["default"]({endpoint:n,SocketConstructor:o}).on("connected",function(){return t.emit("connected")}).on("disconnected",function(){return t.emit("disconnected")})}Object.defineProperty(t,"__esModule",{value:!0}),t.init=o;var u=n(3),i=r(u)},function(e,t,n){!function(t,r){e.exports=r(n(1))}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function(e,t,n){for(var r=!0;r;){var o=e,u=t,i=n;c=a=s=void 0,r=!1,null===o&&(o=Function.prototype);var c=Object.getOwnPropertyDescriptor(o,u);if(void 0!==c){if("value"in c)return c.value;var s=c.get;return void 0===s?void 0:s.call(i)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;e=a,t=u,n=i,r=!0}},s=n(1),a=r(s),f=n(2),l=r(f),p=n(3),d=r(p),h=n(4),v="1",y=["ready","nosub","added","changed","removed","result","updated","error"],g=1e4,b=function(e){function t(e){var n=this;o(this,t),c(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.status="disconnected",this.messageQueue=new l["default"](function(e){return"connected"===n.status?(n.socket.send(e),!0):!1}),this.socket=new d["default"](e.SocketConstructor,e.endpoint),this.socket.on("open",function(){n.socket.send({msg:"connect",version:v,support:[v]})}),this.socket.on("close",function(){n.status="disconnected",n.messageQueue.empty(),n.emit("disconnected"),setTimeout(n.socket.connect.bind(n.socket),g)}),this.socket.on("message:in",function(e){"connected"===e.msg?(n.status="connected",n.messageQueue.process(),n.emit("connected")):"ping"===e.msg?n.socket.send({msg:"pong",id:e.id}):h.contains(y,e.msg)&&n.emit(e.msg,e)}),this.socket.connect()}return u(t,e),i(t,[{key:"emit",value:function(){var e=this,n=arguments;setTimeout(function(){c(Object.getPrototypeOf(t.prototype),"emit",e).apply(e,n)},0)}}]),i(t,[{key:"method",value:function(e,t){var n=h.uniqueId();return this.messageQueue.push({msg:"method",id:n,method:e,params:t}),n}},{key:"sub",value:function(e,t){var n=h.uniqueId();return this.messageQueue.push({msg:"sub",id:n,name:e,params:t}),n}},{key:"unsub",value:function(e){return this.messageQueue.push({msg:"unsub",id:e}),e}}]),t}(a["default"]);t["default"]=b,e.exports=t["default"]},function(t,n){t.exports=e},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this.consumer=t,this.queue=[]}return r(e,[{key:"push",value:function(e){this.queue.push(e),this.process()}},{key:"process",value:function(){var e=this;setTimeout(function(){if(0!==e.queue.length){var t=e.consumer(e.queue[0]);t&&(e.queue.shift(),e.process())}},0)}},{key:"empty",value:function(){this.queue=[]}}]),e}();t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function(e,t,n){for(var r=!0;r;){var o=e,u=t,i=n;c=a=s=void 0,r=!1,null===o&&(o=Function.prototype);var c=Object.getOwnPropertyDescriptor(o,u);if(void 0!==c){if("value"in c)return c.value;var s=c.get;return void 0===s?void 0:s.call(i)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;e=a,t=u,n=i,r=!0}},s=n(1),a=r(s),f=function(e){function t(e,n){o(this,t),c(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.SocketConstructor=e,this.endpoint=n}return u(t,e),i(t,[{key:"emit",value:function(){var e=this,n=arguments;setTimeout(function(){c(Object.getPrototypeOf(t.prototype),"emit",e).apply(e,n)},0)}}]),i(t,[{key:"send",value:function(e){var t=JSON.stringify(e);this.rawSocket.send(t),this.emit("message:out",JSON.parse(t))}},{key:"connect",value:function(){var e=this;this.rawSocket=new this.SocketConstructor(this.endpoint),this.rawSocket.onopen=function(){return e.emit("open")},this.rawSocket.onerror=function(t){return e.emit("error",t)},this.rawSocket.onclose=function(){return e.emit("close")},this.rawSocket.onmessage=function(t){var n;try{n=JSON.parse(t.data)}catch(r){return}e.emit("message:in",n)}}}]),t}(a["default"]);t["default"]=f,e.exports=t["default"]},function(e,t){"use strict";function n(){return(o++).toString()}function r(e,t){return-1!==e.indexOf(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueId=n,t.contains=r;var o=0}])})},function(e,t,n){"use strict";function r(e){return this.call("login",e).then(i.onLogin.bind(this))}function o(){return this.call("logout").then(i.onLogout.bind(this))}function u(){this.userId=null,this.loggedIn=!1,this.ddp.on("connected",i.resumeLogin.bind(this))}Object.defineProperty(t,"__esModule",{value:!0}),t.login=r,t.logout=o,t.init=u;var i=n(5)},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){var t=e.id,n=e.token;return this.userId=t,this.loggedIn=!0,s.set(this.endpoint+"__login_token__",n).then(this.emit.bind(this,"loggedIn",t))}function u(){return this.userId=null,this.loggedIn=!1,s.del(this.endpoint+"__login_token__").then(this.emit.bind(this,"loggedOut"))}function i(){return s.get(this.endpoint+"__login_token__").then(function(e){if(!e)throw new Error("No login token");return{resume:e}}).then(this.login.bind(this))["catch"](u.bind(this))}Object.defineProperty(t,"__esModule",{value:!0}),t.onLogin=o,t.onLogout=u,t.resumeLogin=i;var c=n(6),s=r(c)},function(e,t){"use strict";function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){return new Promise(function(t,n){"undefined"!=typeof chrome&&chrome.storage?chrome.storage.local.get(e,function(n){return t(n[e])}):"undefined"!=typeof localStorage?t(localStorage[e]):"undefined"!=typeof AsyncStorage?AsyncStorage.getItem(e,function(e,r){e?n(e):t(r)}):t(i[e])})}function o(e,t){return new Promise(function(r,o){if("undefined"!=typeof chrome&&chrome.storage){var u=n({},e,t);chrome.storage.local.set(u,r)}else"undefined"!=typeof localStorage?(localStorage[e]=t,r()):"undefined"!=typeof AsyncStorage?AsyncStorage.setItem(e,t,function(e){e?o(e):r()}):(i[e]=t,r())})}function u(e){return new Promise(function(t,n){"undefined"!=typeof chrome&&chrome.storage?chrome.storage.local.remove(e,t):"undefined"!=typeof localStorage?(delete localStorage[e],t()):"undefined"!=typeof AsyncStorage?AsyncStorage.removeItem(e,function(e){e?n(e):t()}):(delete i[e],t())})}Object.defineProperty(t,"__esModule",{value:!0}),t.get=r,t.set=o,t.del=u;var i={}},function(e,t){"use strict";function n(e,t){var n=this;return new Promise(function(r,o){var u=n.ddp.method(e,t);n.methods.cache[u]={resolve:r,reject:o}})}function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return this.apply(e,n)}function o(){var e=this;this.methods={cache:{}},this.ddp.on("result",function(t){var n=t.id,r=t.error,o=t.result,u=e.methods.cache[n];r?u.reject(r):u.resolve(o),delete e.methods.cache[n]})}Object.defineProperty(t,"__esModule",{value:!0}),t.apply=n,t.call=r,t.init=o},function(e,t,n){"use strict";function r(e){var t=e.username,n=e.email,r=e.password,o={password:r,user:{username:t,email:n}};return this.call("createUser",o).then(u.onLogin.bind(this))}function o(e){var t=e.username,n=e.email,r=e.password,o={password:r,user:{username:t,email:n}};return this.call("login",o).then(u.onLogin.bind(this))}Object.defineProperty(t,"__esModule",{value:!0}),t.createUser=r,t.loginWithPassword=o;var u=n(5)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function u(e){var t=e.id,n=e.name,r=e.params,u=e.stillInQueue;u||(this.subscriptions.cache.del(t),this.subscribe.apply(this,[n].concat(o(r))))}function i(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];var o=y["default"](e,n),u=this.subscriptions.cache.get(o);if(!u){var i=this.ddp.sub(e,n),c="connected"!==this.ddp.status;u=f["default"](new p["default"],{fingerprint:o,id:i,name:e,params:n,stillInQueue:c}),this.subscriptions.cache.add(u)}return u}function c(e){this.ddp.unsub(e)}function s(){var e=this;this.subscriptions={cache:new h["default"]},this.ddp.on("ready",function(t){var n=t.subs;n.forEach(function(t){e.subscriptions.cache.get(t).emit("ready")})}).on("nosub",function(t){var n=t.error,r=t.id;n&&e.subscriptions.cache.get(r).emit("error",n),e.subscriptions.cache.del(r)}).on("connected",function(){e.subscriptions.cache.forEach(u.bind(e))})}Object.defineProperty(t,"__esModule",{value:!0}),t.subscribe=i,t.unsubscribe=c,t.init=s;var a=n(10),f=r(a),l=n(1),p=r(l),d=n(21),h=r(d),v=n(22),y=r(v)},function(e,t,n){function r(e,t,n){for(var r=-1,o=i(t),u=o.length;++r<u;){var c=o[r],s=e[c],a=n(s,t[c],c,e,t);(a===a?a===s:s!==s)&&(void 0!==s||c in e)||(e[c]=a)}return e}var o=n(11),u=n(17),i=n(13),c=u(function(e,t,n){return n?r(e,t,n):o(e,t)});e.exports=c},function(e,t,n){function r(e,t){return null==t?e:o(t,u(t),e)}var o=n(12),u=n(13);e.exports=r},function(e,t){function n(e,t,n){n||(n={});for(var r=-1,o=t.length;++r<o;){var u=t[r];n[u]=e[u]}return n}e.exports=n},function(e,t,n){function r(e){return function(t){return null==t?void 0:t[e]}}function o(e){return null!=e&&i(b(e))}function u(e,t){return e="number"==typeof e||d.test(e)?+e:-1,t=null==t?g:t,e>-1&&e%1==0&&t>e}function i(e){return"number"==typeof e&&e>-1&&e%1==0&&g>=e}function c(e){for(var t=a(e),n=t.length,r=n&&e.length,o=!!r&&i(r)&&(p(e)||l(e)),c=-1,s=[];++c<n;){var f=t[c];(o&&u(f,r)||v.call(e,f))&&s.push(f)}return s}function s(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function a(e){if(null==e)return[];s(e)||(e=Object(e));var t=e.length;t=t&&i(t)&&(p(e)||l(e))&&t||0;for(var n=e.constructor,r=-1,o="function"==typeof n&&n.prototype===e,c=Array(t),a=t>0;++r<t;)c[r]=r+"";for(var f in e)a&&u(f,t)||"constructor"==f&&(o||!v.call(e,f))||c.push(f);return c}var f=n(14),l=n(15),p=n(16),d=/^\d+$/,h=Object.prototype,v=h.hasOwnProperty,y=f(Object,"keys"),g=9007199254740991,b=r("length"),m=y?function(e){var t=null==e?void 0:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&o(e)?c(e):s(e)?y(e):[]}:c;e.exports=m},function(e,t){function n(e){return!!e&&"object"==typeof e}function r(e,t){var n=null==e?void 0:e[t];return i(n)?n:void 0}function o(e){return u(e)&&p.call(e)==c}function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function i(e){return null==e?!1:o(e)?d.test(f.call(e)):n(e)&&s.test(e)}var c="[object Function]",s=/^\[object .+?Constructor\]$/,a=Object.prototype,f=Function.prototype.toString,l=a.hasOwnProperty,p=a.toString,d=RegExp("^"+f.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},function(e,t){function n(e){return!!e&&"object"==typeof e}function r(e){return function(t){return null==t?void 0:t[e]}}function o(e){return null!=e&&u(l(e))}function u(e){return"number"==typeof e&&e>-1&&e%1==0&&f>=e}function i(e){return n(e)&&o(e)&&s.call(e,"callee")&&!a.call(e,"callee")}var c=Object.prototype,s=c.hasOwnProperty,a=c.propertyIsEnumerable,f=9007199254740991,l=r("length");e.exports=i},function(e,t){function n(e){return!!e&&"object"==typeof e}function r(e,t){var n=null==e?void 0:e[t];return c(n)?n:void 0}function o(e){return"number"==typeof e&&e>-1&&e%1==0&&g>=e}function u(e){return i(e)&&h.call(e)==a}function i(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function c(e){return null==e?!1:u(e)?v.test(p.call(e)):n(e)&&f.test(e)}var s="[object Array]",a="[object Function]",f=/^\[object .+?Constructor\]$/,l=Object.prototype,p=Function.prototype.toString,d=l.hasOwnProperty,h=l.toString,v=RegExp("^"+p.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),y=r(Array,"isArray"),g=9007199254740991,b=y||function(e){return n(e)&&o(e.length)&&h.call(e)==s};e.exports=b},function(e,t,n){function r(e){return i(function(t,n){var r=-1,i=null==t?0:n.length,c=i>2?n[i-2]:void 0,s=i>2?n[2]:void 0,a=i>1?n[i-1]:void 0;for("function"==typeof c?(c=o(c,a,5),i-=2):(c="function"==typeof a?a:void 0,i-=c?1:0),s&&u(n[0],n[1],s)&&(c=3>i?void 0:c,i=1);++r<i;){var f=n[r];f&&e(t,f,c)}return t})}var o=n(18),u=n(19),i=n(20);e.exports=r},function(e,t){function n(e,t,n){if("function"!=typeof e)return r;if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,o){return e.call(t,n,r,o)};case 4:return function(n,r,o,u){return e.call(t,n,r,o,u)};case 5:return function(n,r,o,u,i){return e.call(t,n,r,o,u,i)}}return function(){return e.apply(t,arguments)}}function r(e){return e}e.exports=n},function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}function r(e){return null!=e&&i(f(e))}function o(e,t){return e="number"==typeof e||s.test(e)?+e:-1,t=null==t?a:t,e>-1&&e%1==0&&t>e}function u(e,t,n){if(!c(n))return!1;var u=typeof t;if("number"==u?r(n)&&o(t,n.length):"string"==u&&t in n){var i=n[t];return e===e?e===i:i!==i}return!1}function i(e){return"number"==typeof e&&e>-1&&e%1==0&&a>=e}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var s=/^\d+$/,a=9007199254740991,f=n("length");e.exports=u},function(e,t){function n(e,t){if("function"!=typeof e)throw new TypeError(r);return t=o(void 0===t?e.length-1:+t||0,0),function(){for(var n=arguments,r=-1,u=o(n.length-t,0),i=Array(u);++r<u;)i[r]=n[t+r];switch(t){case 0:return e.call(this,i);case 1:return e.call(this,n[0],i);case 2:return e.call(this,n[0],n[1],i)}var c=Array(t+1);for(r=-1;++r<t;)c[r]=n[r];return c[t]=i,e.apply(this,c)}}var r="Expected a function",o=Math.max;e.exports=n},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e),this.byFingerprint={},this.byId={}}return r(e,[{key:"add",value:function(e){this.byFingerprint[e.fingerprint]=e,this.byId[e.id]=e}},{key:"get",value:function(e){return this.byId[e]||this.byFingerprint[e]||null}},{key:"del",value:function(e){var t=this.get(e)||{};delete this.byFingerprint[t.fingerprint],delete this.byId[t.id]}},{key:"forEach",value:function(e){var t=this;Object.keys(this.byId).forEach(function(n){e(t.byId[n])})}}]),e}();t["default"]=o,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){return JSON.stringify({name:e,params:t})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n,e.exports=t["default"]}])});